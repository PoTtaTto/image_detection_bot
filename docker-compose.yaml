version: '3.8'

services:
  # PostgreSQL service for storing data
  image_detection_postgres:
    container_name: image_detection_postgres
    image: postgres:alpine3.18
    ports:
      - "5432:${DATABASE_PORT}"  # Map container port 5432 to host port specified by DATABASE_PORT
    environment:
      - POSTGRES_USER=${DATABASE_USER}  # Set PostgreSQL username from DATABASE_USER environment variable
      - POSTGRES_PASSWORD=${DATABASE_PASSWORD}  # Set PostgreSQL password from DATABASE_PASSWORD environment variable
    restart: always
    volumes:
      - image_detection_postgres:/var/lib/postgresql/image_detection_postgres  # Mount volume for persisting PostgreSQL data

  # # Telegram bot and admin panel service
  # image_detection_bot:
  #   build: .
  #   container_name: image_detection_bot
  #   restart: always
  #   ports:
  #     - "${PANEL_PORT}:${PANEL_PORT}"  # Map container port to host port specified by PANEL_PORT
  #   depends_on:
  #     - image_detection_postgres  # Depend on image_detection_postgres service
  #   volumes:
  #     - /root/image_detection_bot/logs:/usr/src/app/image_detection_bot/logs  # Mount volume for storing logs

volumes:
  image_detection_postgres:
    external: true  # Use external volume for persistent storage